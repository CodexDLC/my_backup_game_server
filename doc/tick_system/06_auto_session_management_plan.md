# 7. Управление авто-сессиями

**Цель:** описать вход/выход в авто-режим и блокировку.

1. **Сессии:** время старта, `last_tick_at`, `next_tick_at`, `active_category`.
2. **API:** endpoints для старта и остановки сессии.
3. **Планирование:** выборка готовых сессий, обновление расписаний.
4. **Блокировка:** пометка «в процессе» при обработке.
5. **Тесты:** создание, удаление, корректное смещение `next_tick_at`.
6. **Логирование:**

   * События старта и остановки авто-сессий: `character_id`, время, статус.
   * Ошибки при активации или деактивации.
   * Конфликтные статусы или повторная активация.
7. **Метрики Prometheus:**

   * `auto_sessions_started_total`
   * `auto_sessions_stopped_total`
   * `auto_session_duration_seconds`
   * `auto_session_errors_total`
